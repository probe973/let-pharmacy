{% assign quiz_data = site.data[include.source] %}

<section id="quiz-container" class="quiz-container" aria-labelledby="quiz-heading">
    <h2 id="quiz-heading">Pharmacy Calculations Quiz</h2>
    
    <div class="quiz-status" aria-live="polite">
        <p>Question <span id="current-q-num">0</span> of 20</p>
        <p>Score: <span id="score-count">0</span>/20</p>
        <p>Time elapsed: <span id="timer-display">0:00</span></p>
    </div>

    <div id="quiz-box">
        <div id="question-text" class="question-box" role="region" aria-live="assertive"></div>

        <div class="answer-section">
            <label for="user-answer">Your Answer (numerical):</label>
            <input type="number" id="user-answer" step="any" placeholder="Enter value..." required>
            
            <div class="button-group">
                <button id="btn-check" class="btn">Check Answer</button>
                <button id="btn-solution" class="btn btn-secondary" disabled>Show Solution</button>
                <button id="btn-next" class="btn" style="display:none;">Next Question</button>
            </div>
        </div>

        <div id="feedback" class="feedback-box" aria-live="polite"></div>
        
        <div id="solution-box" class="solution-box" style="display:none;" role="region" aria-label="Step by step solution">
            <strong>Solution:</strong>
            <div id="solution-text"></div>
        </div>
    </div>

    <div id="final-results" style="display:none;">
        <h3>Quiz Complete!</h3>
        <p>Final Score: <span id="final-score"></span>/20</p>
        <p>Total Time: <span id="final-time"></span></p>
        <button onclick="location.reload()" class="btn">Restart Quiz</button>
    </div>
</section>

<script>
    // This part converts your YAML data into JavaScript
    // If the data is missing, it creates an empty list [] so the build doesn't crash
    const allQuestions = {{ quiz_data | jsonify | default: '[]' }};
    
    if (allQuestions.length === 0) {
        document.getElementById('quiz-box').innerHTML = "<p role='alert' style='color:red; font-weight:bold;'>Error: The data file '_data/{{ include.source }}.yml' was not found or is empty.</p>";
    }
</script>
